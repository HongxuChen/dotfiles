# -*- mode:sh -*-
# vim:ft=sh

# if ! [ $DISPLAY ]; then
source ~/.profile
# fi

export PAGER="less"
export LESS="-R -i -g -c -W"
export LESS_TERMCAP_mb=$'\E[01;31m'
export LESS_TERMCAP_md=$'\E[01;31m'
export LESS_TERMCAP_me=$'\E[0m'
export LESS_TERMCAP_se=$'\E[0m'
export LESS_TERMCAP_so=$'\E[01;44;33m'
export LESS_TERMCAP_ue=$'\E[0m'
export LESS_TERMCAP_us=$'\E[01;32m'
export LESSOPEN='|/usr/bin/lesspipe %s'
export LESSCLOSE='/usr/bin/lesspipe %s %s'
export TEXMFHOME=~/.texmf

#grep
export GREP_OPTIONS='--color=auto'
export GREP_COLOR='1;32'

MY_ROOT=~/RESEARCH
MY_WLLVM_ROOT=${MY_ROOT}/wllvm

mac_set_up() {
    export MY_BREW_PREFIX=/usr/local
    export PATH=/usr/sbin:/sbin:/usr/bin:/bin:/opt/local/bin
    export PATH=${MY_BREW_PREFIX}/bin:$PATH
    export PATH=/usr/texbin:$PATH
    export PATH=${MY_BREW_PREFIX}/opt/llvm/bin:$PATH
    export PATH=~/Library/Python/2.7/bin:$PATH
    export PATH=~/tools/dotfiles/_builds/rtags/build/bin:$PATH
    export PATH=${MY_WLLVM_ROOT}:$PATH

    export LD_LIBRARY_PATH=
    export LD_LIBRARY_PATH=/usr/local/Cellar/llvm/3.5.0/lib

    export CPLUS_INCLUDE_PATH=
    export CPLUS_INCLUDE_PATH=/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/../include/c++/v1
    export CPLUS_INCLUDE_PATH=/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include:${CPLUS_INCLUDE_PATH}
    export C_INCLUDE_PATH=

}

linux_set_up(){

    MY_LLVM_ROOT=${MY_ROOT}/llvm-3.4
    MY_LLVM_OBJ=${MY_LLVM_ROOT}/obj/Release+Asserts
    MY_CLANG_TOOLS=${MY_LLVM_ROOT}/src/tools/clang/tools
    MY_STP_INSTALL=${MY_ROOT}/stp/install
    MY_KLEE_INSTALL=${MY_ROOT}/klee/install
    MY_KLEE_OBJ=${MY_ROOT}/klee/obj
    MY_KLEE_INCLUDE=${MY_ROOT}/klee/src/include
    MY_PIN_ROOT=~/repos/pintool/pin
    export MY_CLANG_TOOLS

    export PATH=/usr/sbin:/sbin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games

    export MY_BREW_PREFIX=$HOME/.linuxbrew
    export PATH=${MY_BREW_PREFIX}/bin:$PATH

    export PATH=/usr/local/texlive/2014/Bin/x86_64-linux:$PATH
    export PATH=${MY_LLVM_OBJ}/bin:${MY_CLANG_TOOLS}/scan-build:${MY_CLANG_TOOLS}/scan-view:${MY_STP_INSTALL}/bin:$PATH
    export PATH=${MY_WLLVM_ROOT}:$PATH
    export PATH=${MY_KLEE_INSTALL}/bin:$PATH
    export PATH=${MY_PIN_ROOT}:$PATH
    export PATH=~/tools/dotfiles/_builds/rtags/build/bin:$PATH
    export PATH=~/tools/FSharp-2.0.0.0/bin:$PATH
    export PATH=:~/.bin:~/.local/bin:$PATH

    export CPLUS_INCLUDE_PATH=
    export CPLUS_INCLUDE_PATH=${MY_BREW_PREFIX}/include:${CPLUS_INCLUDE_PATH}
    export CPLUS_INCLUDE_PATH=~/qemu/panda/distorm/include:${CPLUS_INCLUDE_PATH}
    export CPLUS_INCLUDE_PATH=${MY_KLEE_INCLUDE}:${MY_KLEE_INCLUDE}/../../obj/include:${CPLUS_INCLUDE_PATH}
    export C_INCLUDE_PATH=${CPLUS_INCLUDE_PATH}
    # export CPLUS_INCLUDE_PATH=${MY_LLVM_ROOT}/src/tools/clang/include:${MY_LLVM_ROOT}/obj/tools/clang/include:${CPLUS_INCLUDE_PATH}

    export LD_LIBRARY_PATH=
    export LD_LIBRARY_PATH=${MY_LLVM_OBJ}/lib:${MY_STP_INSTALL}/lib
    export LD_LIBRARY_PATH=${MY_BREW_PREFIX}:${LD_LIBRARY_PATH}

    export PYTHONPATH=
    export PYTHONPATH=/usr/lib/python2.7/site-packages:${MY_LLVM_ROOT}/src/tools/clang/bindings/python:$PYTHONPATH

    stty ixany
    stty ixoff -ixon
}

if [[ $OSTYPE == "linux-gnu" ]];then
    linux_set_up
elif [[ $OSTYPE == "darwin"* ]];then
    mac_set_up
fi

###

# for wllvm
export LLVM_COMPILER=clang
export WLLVM_OUTPUT=INFO

export CC=clang
export CXX=clang++

# load executable
(pgrep -x rdm >/dev/null || rdm &>/tmp/rdm_answer &)
