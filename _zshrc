# -- mode:sh -*-

ZSH=${HOME}/.oh-my-zsh

# ZSH_THEME="bira"
# ZSH_THEME="dst"
ZSH_THEME="nanotech"

# ~/.oh-my-zsh/plugins/
if [[ $OSTYPE == "linux-gnu" ]]; then
    plugins=(ag pip debian svn brew git-extras gem vi-mode)
elif [[ $OSTYPE == "darwin"* ]]; then
    plugins=(ag pip brew git-extras gem vi-mode)
fi

source ~/.aliases
source ~/.zprofile
for config_file ($ZSH/lib/*.zsh); do
    source $config_file
done
unset config_file

is_plugin() {
    local base_dir=$1
    local name=$2
    test -f $base_dir/plugins/$name/$name.plugin.zsh \
        || test -f $base_dir/plugins/$name/_$name
}

# Add all defined plugins to fpath. This must be done
# before running compinit.
for plugin ($plugins); do
    if is_plugin $ZSH $plugin; then
        fpath=($ZSH/plugins/$plugin $fpath)
    else
        printf "$ZSH/plugins/$plugin not plugin\n"
    fi
done

# Load and run compinit
autoload -U compinit
compinit -i

for plugin ($plugins); do
    if [ -f $ZSH/plugins/$plugin/$plugin.plugin.zsh ]; then
        source $ZSH/plugins/$plugin/$plugin.plugin.zsh
    fi
done

###  sources

source "$ZSH/themes/${ZSH_THEME}.zsh-theme"

source ${MY_BREW_PREFIX}/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
source ${MY_BREW_PREFIX}/Cellar/zsh-history-substring-search/1.0.0/zsh-history-substring-search.zsh

# bind Ctrl-P/Ctrl-N for Emacs mode
bindkey -M emacs '^P' history-substring-search-up
bindkey -M emacs '^N' history-substring-search-down
# bind k and j for VI mode
bindkey -M vicmd 'k' history-substring-search-up
bindkey -M vicmd 'j' history-substring-search-down

bindkey -M vicmd '^f' vi-forward-word
bindkey -M vicmd '^f' vi-forward-blank-word
